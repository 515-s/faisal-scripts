--// Services
local Workspace = game:GetService("Workspace")

--// نسخ الاسم
local function copy(text)
	if setclipboard then setclipboard(text) end
end

--// دالة تعرف اللون بالعربي أو Gold/Rainbow
local function colorNameFromColor3(color, part)
	-- Gold تقريبا: R=1, G>0.8, B<0.2
	if color.R > 0.9 and color.G > 0.7 and color.B < 0.3 then
		return "ذهبي"
	end
	-- Rainbow: نقدر نفحص اذا Material = Neons وتغير مستمر (تقريب)
	if part:FindFirstChildWhichIsA("ColorSequence") or part.Material == Enum.Material.Neon then
		return "متعدد"
	end

	-- نحسب لو رمادي
	local r,g,b = color.R, color.G, color.B
	local maxDiff = math.max(math.abs(r-g), math.abs(r-b), math.abs(g-b))
	if maxDiff < 0.05 then
		if r < 0.1 then return "أسود"
		elseif r > 0.9 then return "أبيض"
		else return "رمادي" end
	end

	-- باقي الألوان بالتقريب
	if r > g and r > b then return "أحمر"
	elseif g > r and g > b then return "أخضر"
	elseif b > r and b > g then return "أزرق"
	elseif r > 0.8 and g > 0.8 and b < 0.3 then return "أصفر"
	else return "غير معروف"
	end
end

--// إنشاء نص فوق البارت
local function setLabelOnPart(part, text)
	if not part or not part.Parent then return end
	local billboard = part:FindFirstChild("ColorLabelGui")
	if not billboard then
		billboard = Instance.new("BillboardGui")
		billboard.Name = "ColorLabelGui"
		billboard.Adornee = part
		billboard.Size = UDim2.new(0,150,0,50)
		billboard.StudsOffset = Vector3.new(0, part.Size.Y/2 + 2, 0)
		billboard.AlwaysOnTop = true
		billboard.Parent = part

		local label = Instance.new("TextLabel")
		label.Name = "ColorLabel"
		label.Size = UDim2.new(1,0,1,0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.fromRGB(255,255,255)
		label.TextScaled = true
		label.Font = Enum.Font.SourceSansBold
		label.Parent = billboard
	end

	local lbl = billboard:FindFirstChild("ColorLabel")
	if lbl then lbl.Text = text end
end

--// إنشاء البارت
local function createMarker(model)
	local main = model.PrimaryPart or model:FindFirstChildWhichIsA("BasePart")
	if not main then return nil end

	local part = Instance.new("Part")
	part.Size = Vector3.new(1,10,1) -- طول البارت 10
	part.Color = Color3.fromRGB(128,128,128) -- لا يتلون
	part.Material = Enum.Material.Neon
	part.CanCollide = false
	part.Anchored = false
	part.Name = "Marker"

	part.CFrame = main.CFrame * CFrame.new(0,20,0)

	local weld = Instance.new("WeldConstraint")
	weld.Part0 = part
	weld.Part1 = main
	weld.Parent = part

	local click = Instance.new("ClickDetector", part)
	click.MaxActivationDistance = 50
	click.MouseClick:Connect(function() copy(model.Name) end)

	part.Parent = model
	return part
end

--// فحص الموديلات وإنشاء البارت
local added = {}
local markers = {}

local function check(obj)
	if obj:IsA("Model") and #obj.Name > 20 and not added[obj] then
		added[obj] = true
		local part = createMarker(obj)
		if part then table.insert(markers, part) end
	end
end

for _,v in ipairs(Workspace:GetDescendants()) do check(v) end
Workspace.DescendantAdded:Connect(check)

--// مراقبة لون البارت كل ثانية
spawn(function()
	while true do
		for _, part in ipairs(markers) do
			if part and part.Parent then
				local name = colorNameFromColor3(part.Color, part)
				setLabelOnPart(part, name)
			end
		end
		wait(1)
	end
end)
