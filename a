--// Services
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local MARK_SIZE = 6

-- يخليه ظاهر دايم
local function forceVisible(obj)
	if obj:IsA("BasePart") then
		obj.Transparency = 0
		obj.LocalTransparencyModifier = 0
		obj.Material = Enum.Material.Neon
		obj.Color = Color3.fromRGB(255,0,0)
		obj.CanCollide = false
	end
end

-- يرسم كرة النهاية
local function createMark(pos)
	local p = Instance.new("Part")
	p.Shape = Enum.PartType.Ball
	p.Size = Vector3.new(MARK_SIZE, MARK_SIZE, MARK_SIZE)
	p.Anchored = true
	p.CanCollide = false
	p.Material = Enum.Material.Neon
	p.Color = Color3.fromRGB(255, 0, 0)
	p.Position = pos
	p.Name = "BombLastPosition"
	p.Parent = workspace
end

-- يرجع موقع البومب الحقيقي
local function getPosition(obj)
	if obj:IsA("Model") then
		local cf = obj:GetBoundingBox()
		return cf.Position
	elseif obj:IsA("BasePart") then
		return obj.Position
	end
end

-- تتبع دقيق
local function trackBomb(bomb)
	local lastPos = getPosition(bomb)
	if not lastPos then return end

	local connection
	connection = RunService.RenderStepped:Connect(function()
		if not bomb.Parent then
			connection:Disconnect()
			createMark(lastPos) -- آخر مكان حرفيًا
			return
		end

		local pos = getPosition(bomb)
		if pos then
			lastPos = pos
		end

		for _,v in pairs(bomb:GetDescendants()) do
			forceVisible(v)
		end
	end)
end

-- فحص الموجود
for _,v in pairs(Workspace:GetDescendants()) do
	if v.Name == "Bomb" then
		task.spawn(trackBomb, v)
	end
end

-- فحص الجديد
Workspace.DescendantAdded:Connect(function(obj)
	if obj.Name == "Bomb" then
		task.spawn(trackBomb, obj)
	end
end)
