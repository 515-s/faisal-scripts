--// Services
local Workspace = game:GetService("Workspace")

-- حجم البارتات
local BOX_SIZE = Vector3.new(2,2,2)
local GAP = 0.3
local HEIGHT_OFFSET = 5

-- دالة تجمع كل ألوان النصوص داخل الموديل
local function getTextColors(model)
	local colors = {}

	for _, obj in ipairs(model:GetDescendants()) do
		if obj:IsA("TextLabel") or obj:IsA("TextButton") or obj:IsA("TextBox") then
			local c = obj.TextColor3
			local key = tostring(c)
			if not colors[key] then
				colors[key] = c
			end
		elseif obj:IsA("SurfaceGui") or obj:IsA("BillboardGui") then
			for _, guiObj in ipairs(obj:GetDescendants()) do
				if guiObj:IsA("TextLabel") or guiObj:IsA("TextButton") or guiObj:IsA("TextBox") then
					local c = guiObj.TextColor3
					local key = tostring(c)
					if not colors[key] then
						colors[key] = c
					end
				end
			end
		end
	end

	return colors
end

-- دالة تنشئ بارت لكل لون نص
local function showTextColors(model)
	if not model.PrimaryPart then return end

	local colors = getTextColors(model)
	local list = {}
	for _, c in pairs(colors) do
		table.insert(list, c)
	end

	if #list == 0 then return end

	-- ترتيب حسب السطوع
	table.sort(list, function(a,b)
		return (a.R + a.G + a.B) < (b.R + b.G + b.B)
	end)

	local basePos = model.PrimaryPart.Position
	local startX = -(#list/2) * (BOX_SIZE.X + GAP)

	for i, color in ipairs(list) do
		local part = Instance.new("Part")
		part.Size = BOX_SIZE
		part.Anchored = true
		part.CanCollide = false
		part.Color = color
		part.Name = "TextColorPreview"
		part.Parent = model

		part.Position =
			basePos +
			Vector3.new(startX + (i*(BOX_SIZE.X+GAP)), HEIGHT_OFFSET, 0)
	end
end

-- فحص كل الموديلات
for _, obj in ipairs(Workspace:GetDescendants()) do
	if obj:IsA("Model") and obj.PrimaryPart then
		showTextColors(obj)
	end
end
