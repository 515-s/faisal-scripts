local player = game.Players.LocalPlayer

local coords = {
	Vector3.new(200, -3, 0),
	Vector3.new(284, -3, 0),
	Vector3.new(396, -3, 0),
}

local index = 1
local moving = false
local root

local gui = player.PlayerGui:FindFirstChild("TeleportGUI")
if not gui then
	gui = Instance.new("ScreenGui", player.PlayerGui)
	gui.Name = "TeleportGUI"
	gui.ResetOnSpawn = false
end

-- القائمة السوداء (أطول للأسفل)
local frame = gui:FindFirstChild("BlackMenu")
if not frame then
	frame = Instance.new("Frame")
	frame.Name = "BlackMenu"
	frame.Size = UDim2.new(0, 250, 0, 200) -- أطول تحت
	frame.Position = UDim2.new(0, 100, 0, 100)
	frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
	frame.Active = true
	frame.Draggable = true
	frame.Parent = gui
end

-- الخانة الرمادية للزر الأول
local grayBox = frame:FindFirstChild("GrayBox")
if not grayBox then
	grayBox = Instance.new("Frame")
	grayBox.Name = "GrayBox"
	grayBox.Size = UDim2.new(1, -20, 0, 30)
	grayBox.Position = UDim2.new(0, 10, 0, 60)
	grayBox.BackgroundColor3 = Color3.fromRGB(80,80,80)
	grayBox.Parent = frame
end

-- زر النقل الأول
local btn = grayBox:FindFirstChild("TeleportButton")
if not btn then
	btn = Instance.new("TextButton")
	btn.Name = "TeleportButton"
	btn.Size = UDim2.new(1, 0, 1, 0)
	btn.Position = UDim2.new(0,0,0,0)
	btn.Text = "Teleport"
	btn.TextScaled = true
	btn.TextColor3 = Color3.fromRGB(0,255,0)
	btn.Font = Enum.Font.GothamMedium
	btn.BackgroundTransparency = 1
	btn.Parent = grayBox
end

-- زر فارغ تحت الزر الأول
local blankBtn = frame:FindFirstChild("BlankButton")
if not blankBtn then
	blankBtn = Instance.new("TextButton")
	blankBtn.Name = "BlankButton"
	blankBtn.Size = UDim2.new(1, -20, 0, 30)
	blankBtn.Position = UDim2.new(0, 10, 0, 100) -- أسفل الزر الأول
	blankBtn.BackgroundColor3 = Color3.fromRGB(100,100,100)
	blankBtn.Text = ""
	blankBtn.Parent = frame
end

local function getRoot()
	local char = player.Character
	return char and char:FindFirstChild("HumanoidRootPart")
end

player.CharacterAdded:Connect(function()
	root = nil
	moving = false
end)

local function resetToFirst()
	root = getRoot()
	if root and index ~= #coords then -- لو وصلت للثالثة ما نرجعك
		root.CFrame = CFrame.new(coords[1])
		index = 1
	end
	moving = false
end

local function tpStep(target)
	moving = true
	root = getRoot()
	if not root then
		resetToFirst()
		return
	end

	root.CFrame += Vector3.new(0,10,0)
	task.wait(0.01)

	while true do
		root = getRoot()
		if not root or not root.Parent then
			resetToFirst()
			return
		end

		local diff = target - root.Position
		local dist = diff.Magnitude
		if dist <= 0.05 then break end

		root.CFrame = CFrame.new(root.Position + diff.Unit * math.min(10, dist))
		task.wait(0.01)
	end

	if root and root.Parent then
		root.CFrame = CFrame.new(target)
	end

	moving = false
end

-- إضافة تأثير الضغط على الزر (يصير رمادي غامق)
btn.MouseButton1Down:Connect(function()
	btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
end)
btn.MouseButton1Up:Connect(function()
	btn.BackgroundColor3 = Color3.fromRGB(80,80,80)
end)

btn.MouseButton1Click:Connect(function()
	if moving then return end
	tpStep(coords[index])
	index += 1
	if index > #coords then
		index = #coords -- لو وصلنا آخر إحداثية، ما نرجع
	end
end)
