local player = game.Players.LocalPlayer

local coords = {
	Vector3.new(200, -3, 0),
	Vector3.new(283, -3, -1),
	Vector3.new(398, -3, 0),
	Vector3.new(542, -3, 0),
	Vector3.new(756, -3, 0),
	Vector3.new(1070, -3, 0),
	Vector3.new(1543, -3, 0),
	Vector3.new(2239, -3, 3),
	Vector3.new(2587, -3, 0),
}

local currentIndex = 0
local moving = false
local needReset = false

local gui = player.PlayerGui:FindFirstChild("TeleportGUI")
if not gui then
	gui = Instance.new("ScreenGui", player.PlayerGui)
	gui.Name = "TeleportGUI"
	gui.ResetOnSpawn = false
end

local frame = gui:FindFirstChild("BlackMenu")
if not frame then
	frame = Instance.new("Frame")
	frame.Name = "BlackMenu"
	frame.Size = UDim2.new(0, 250, 0, 600)
	frame.Position = UDim2.new(0, 100, 0, 100)
	frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
	frame.Active = true
	frame.Draggable = true
	frame.Parent = gui
end

local forwardBox = frame:FindFirstChild("ForwardBox")
if not forwardBox then
	forwardBox = Instance.new("Frame")
	forwardBox.Name = "ForwardBox"
	forwardBox.Size = UDim2.new(1, -20, 0, 30)
	forwardBox.Position = UDim2.new(0, 10, 0, 20)
	forwardBox.BackgroundColor3 = Color3.fromRGB(160,160,160)
	forwardBox.Parent = frame
end

local forwardBtn = forwardBox:FindFirstChild("Forward")
if not forwardBtn then
	forwardBtn = Instance.new("TextButton")
	forwardBtn.Name = "Forward"
	forwardBtn.Size = UDim2.new(1, 0, 1, 0)
	forwardBtn.Position = UDim2.new(0,0,0,0)
	forwardBtn.Text = "Forward"
	forwardBtn.TextScaled = true
	forwardBtn.TextColor3 = Color3.fromRGB(0,255,0)
	forwardBtn.Font = Enum.Font.GothamBold
	forwardBtn.BackgroundTransparency = 0
	forwardBtn.BackgroundColor3 = Color3.fromRGB(160,160,160)
	forwardBtn.Parent = forwardBox
end

local backBox = frame:FindFirstChild("BackBox")
if not backBox then
	backBox = Instance.new("Frame")
	backBox.Name = "BackBox"
	backBox.Size = UDim2.new(1, -20, 0, 30)
	backBox.Position = UDim2.new(0, 10, 0, 60)
	backBox.BackgroundColor3 = Color3.fromRGB(160,160,160)
	backBox.Parent = frame
end

local backBtn = backBox:FindFirstChild("Back")
if not backBtn then
	backBtn = Instance.new("TextButton")
	backBtn.Name = "Back"
	backBtn.Size = UDim2.new(1,0,1,0)
	backBtn.Position = UDim2.new(0,0,0,0)
	backBtn.Text = "Back"
	backBtn.TextScaled = true
	backBtn.TextColor3 = Color3.fromRGB(0,255,0)
	backBtn.Font = Enum.Font.GothamBold
	backBtn.BackgroundTransparency = 0
	backBtn.BackgroundColor3 = Color3.fromRGB(160,160,160)
	backBtn.Parent = backBox
end

local function getRoot()
	local char = player.Character
	return char and char:FindFirstChild("HumanoidRootPart")
end

player.CharacterAdded:Connect(function(char)
	moving = false
	if needReset then
		local r = char:WaitForChild("HumanoidRootPart")
		if r then
			r.CFrame = CFrame.new(coords[1])
			currentIndex = 1
		end
		needReset = false
	end
end)

local function initiateReset()
	moving = false
	currentIndex = 1
	local r = getRoot()
	if r then
		pcall(function() r.CFrame = CFrame.new(coords[1]) end)
	else
		needReset = true
	end
end

local function tpStep(target)
	moving = true
	local root = getRoot()
	if not root then
		initiateReset()
		return
	end

	root.CFrame = root.CFrame + Vector3.new(0,10,0)
	task.wait(0.01)

	while true do
		root = getRoot()
		if not root or not root.Parent then
			initiateReset()
			return
		end

		local diff = target - root.Position
		local dist = diff.Magnitude
		if dist <= 0.05 then break end

		root.CFrame = CFrame.new(root.Position + diff.Unit * math.min(10, dist))
		task.wait(0.01)
	end

	root = getRoot()
	if root and root.Parent then
		root.CFrame = CFrame.new(target)
	end
	moving = false
end

forwardBtn.MouseButton1Down:Connect(function()
	forwardBtn.BackgroundColor3 = Color3.fromRGB(100,100,100)
end)
forwardBtn.MouseButton1Up:Connect(function()
	forwardBtn.BackgroundColor3 = Color3.fromRGB(160,160,160)
end)

backBtn.MouseButton1Down:Connect(function()
	backBtn.BackgroundColor3 = Color3.fromRGB(100,100,100)
end)
backBtn.MouseButton1Up:Connect(function()
	backBtn.BackgroundColor3 = Color3.fromRGB(160,160,160)
end)

forwardBtn.MouseButton1Click:Connect(function()
	if moving then return end
	local targetIndex = currentIndex + 1
	if targetIndex > #coords then return end
	tpStep(coords[targetIndex])
	currentIndex = targetIndex
end)

backBtn.MouseButton1Click:Connect(function()
	if moving then return end
	if currentIndex == 0 then return end
	if currentIndex > #coords then
		currentIndex = #coords
	end
	local targetIndex = currentIndex - 1
	if targetIndex < 1 then return end
	tpStep(coords[targetIndex])
	currentIndex = targetIndex
end)
